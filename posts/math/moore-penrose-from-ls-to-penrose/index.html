<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线 | Blog</title><meta name=keywords content="Linear Algebra,Least Squares,Pseudoinverse,Moore-Penrose"><meta name=description content="
这篇笔记按证明顺序组织：
最小二乘 ⇒ 正交投影，最小范数 ⇒ 与 kernel 正交，
进而“自然构造”出 $A^+$，再推出 Penrose 四条件与唯一性，并回答“会不会无解”。


1. 问题动机：为什么摩尔逆看上去“旱地拔葱”？
如果只从“广义逆”的等式出发，Penrose 四条件

  
$
AXA=A,\quad XAX=X,\quad (AX)^\top=AX,\quad (XA)^\top=XA
$



像是凭空列出的约束。更自然的起点其实是一个极其朴素的问题：

给定 $A\in\mathbb{R}^{m\times n}$ 与 $b\in\mathbb{R}^m$，
先求最小二乘 $\min_x |Ax-b|_2$；若解不唯一，再在所有最小二乘解中选范数最小的那个。

这条路线会把“代数等式”还原成“几何投影”。

2. 最小二乘 ⇒ 残差与列空间正交（正交投影）
考虑目标函数

  
$
f(x)=\|Ax-b\|_2^2=(Ax-b)^\top(Ax-b).
$



令残差 $r(x)=Ax-b$。对 $x$ 求梯度：

  
$
\nabla f(x)=2A^\top(Ax-b)=2A^\top r(x).
$



此处补充一个求矩阵函数梯度的小技巧：

  
$$
f(x + \delta) - f(x) = \langle \nabla f(x), \delta\rangle + o(infinitesimal)
$$



只要表示为这个形式，就能够知道梯度是什么。"><meta name=author content><link rel=canonical href=https://analyst-huang.github.io/posts/math/moore-penrose-from-ls-to-penrose/><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=https://analyst-huang.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://analyst-huang.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://analyst-huang.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://analyst-huang.github.io/apple-touch-icon.png><link rel=mask-icon href=https://analyst-huang.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://analyst-huang.github.io/posts/math/moore-penrose-from-ls-to-penrose/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\\\(",right:"\\\\)",display:!1},{left:"\\\\[",right:"\\\\]",display:!0}]})})</script><meta property="og:url" content="https://analyst-huang.github.io/posts/math/moore-penrose-from-ls-to-penrose/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线"><meta property="og:description" content=" 这篇笔记按证明顺序组织：
最小二乘 ⇒ 正交投影，最小范数 ⇒ 与 kernel 正交，
进而“自然构造”出 $A^+$，再推出 Penrose 四条件与唯一性，并回答“会不会无解”。
1. 问题动机：为什么摩尔逆看上去“旱地拔葱”？ 如果只从“广义逆”的等式出发，Penrose 四条件
$ AXA=A,\quad XAX=X,\quad (AX)^\top=AX,\quad (XA)^\top=XA $ 像是凭空列出的约束。更自然的起点其实是一个极其朴素的问题：
给定 $A\in\mathbb{R}^{m\times n}$ 与 $b\in\mathbb{R}^m$，
先求最小二乘 $\min_x |Ax-b|_2$；若解不唯一，再在所有最小二乘解中选范数最小的那个。
这条路线会把“代数等式”还原成“几何投影”。
2. 最小二乘 ⇒ 残差与列空间正交（正交投影） 考虑目标函数
$ f(x)=\|Ax-b\|_2^2=(Ax-b)^\top(Ax-b). $ 令残差 $r(x)=Ax-b$。对 $x$ 求梯度：
$ \nabla f(x)=2A^\top(Ax-b)=2A^\top r(x). $ 此处补充一个求矩阵函数梯度的小技巧： $$ f(x + \delta) - f(x) = \langle \nabla f(x), \delta\rangle + o(infinitesimal) $$ 只要表示为这个形式，就能够知道梯度是什么。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-30T00:00:00+00:00"><meta property="article:modified_time" content="2026-01-30T00:00:00+00:00"><meta property="article:tag" content="Linear Algebra"><meta property="article:tag" content="Least Squares"><meta property="article:tag" content="Pseudoinverse"><meta property="article:tag" content="Moore-Penrose"><meta name=twitter:card content="summary"><meta name=twitter:title content="从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线"><meta name=twitter:description content="
这篇笔记按证明顺序组织：
最小二乘 ⇒ 正交投影，最小范数 ⇒ 与 kernel 正交，
进而“自然构造”出 $A^+$，再推出 Penrose 四条件与唯一性，并回答“会不会无解”。


1. 问题动机：为什么摩尔逆看上去“旱地拔葱”？
如果只从“广义逆”的等式出发，Penrose 四条件

  
$
AXA=A,\quad XAX=X,\quad (AX)^\top=AX,\quad (XA)^\top=XA
$



像是凭空列出的约束。更自然的起点其实是一个极其朴素的问题：

给定 $A\in\mathbb{R}^{m\times n}$ 与 $b\in\mathbb{R}^m$，
先求最小二乘 $\min_x |Ax-b|_2$；若解不唯一，再在所有最小二乘解中选范数最小的那个。

这条路线会把“代数等式”还原成“几何投影”。

2. 最小二乘 ⇒ 残差与列空间正交（正交投影）
考虑目标函数

  
$
f(x)=\|Ax-b\|_2^2=(Ax-b)^\top(Ax-b).
$



令残差 $r(x)=Ax-b$。对 $x$ 求梯度：

  
$
\nabla f(x)=2A^\top(Ax-b)=2A^\top r(x).
$



此处补充一个求矩阵函数梯度的小技巧：

  
$$
f(x + \delta) - f(x) = \langle \nabla f(x), \delta\rangle + o(infinitesimal)
$$



只要表示为这个形式，就能够知道梯度是什么。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://analyst-huang.github.io/posts/"},{"@type":"ListItem","position":2,"name":"从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线","item":"https://analyst-huang.github.io/posts/math/moore-penrose-from-ls-to-penrose/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线","name":"从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线","description":" 这篇笔记按证明顺序组织：\n最小二乘 ⇒ 正交投影，最小范数 ⇒ 与 kernel 正交，\n进而“自然构造”出 $A^+$，再推出 Penrose 四条件与唯一性，并回答“会不会无解”。\n1. 问题动机：为什么摩尔逆看上去“旱地拔葱”？ 如果只从“广义逆”的等式出发，Penrose 四条件\n$ AXA=A,\\quad XAX=X,\\quad (AX)^\\top=AX,\\quad (XA)^\\top=XA $ 像是凭空列出的约束。更自然的起点其实是一个极其朴素的问题：\n给定 $A\\in\\mathbb{R}^{m\\times n}$ 与 $b\\in\\mathbb{R}^m$，\n先求最小二乘 $\\min_x |Ax-b|_2$；若解不唯一，再在所有最小二乘解中选范数最小的那个。\n这条路线会把“代数等式”还原成“几何投影”。\n2. 最小二乘 ⇒ 残差与列空间正交（正交投影） 考虑目标函数\n$ f(x)=\\|Ax-b\\|_2^2=(Ax-b)^\\top(Ax-b). $ 令残差 $r(x)=Ax-b$。对 $x$ 求梯度：\n$ \\nabla f(x)=2A^\\top(Ax-b)=2A^\\top r(x). $ 此处补充一个求矩阵函数梯度的小技巧： $$ f(x + \\delta) - f(x) = \\langle \\nabla f(x), \\delta\\rangle + o(infinitesimal) $$ 只要表示为这个形式，就能够知道梯度是什么。\n","keywords":["Linear Algebra","Least Squares","Pseudoinverse","Moore-Penrose"],"articleBody":" 这篇笔记按证明顺序组织：\n最小二乘 ⇒ 正交投影，最小范数 ⇒ 与 kernel 正交，\n进而“自然构造”出 $A^+$，再推出 Penrose 四条件与唯一性，并回答“会不会无解”。\n1. 问题动机：为什么摩尔逆看上去“旱地拔葱”？ 如果只从“广义逆”的等式出发，Penrose 四条件\n$ AXA=A,\\quad XAX=X,\\quad (AX)^\\top=AX,\\quad (XA)^\\top=XA $ 像是凭空列出的约束。更自然的起点其实是一个极其朴素的问题：\n给定 $A\\in\\mathbb{R}^{m\\times n}$ 与 $b\\in\\mathbb{R}^m$，\n先求最小二乘 $\\min_x |Ax-b|_2$；若解不唯一，再在所有最小二乘解中选范数最小的那个。\n这条路线会把“代数等式”还原成“几何投影”。\n2. 最小二乘 ⇒ 残差与列空间正交（正交投影） 考虑目标函数\n$ f(x)=\\|Ax-b\\|_2^2=(Ax-b)^\\top(Ax-b). $ 令残差 $r(x)=Ax-b$。对 $x$ 求梯度：\n$ \\nabla f(x)=2A^\\top(Ax-b)=2A^\\top r(x). $ 此处补充一个求矩阵函数梯度的小技巧： $$ f(x + \\delta) - f(x) = \\langle \\nabla f(x), \\delta\\rangle + o(infinitesimal) $$ 只要表示为这个形式，就能够知道梯度是什么。\n若 $x_*$ 为极小点，则一阶必要条件\n$ A^\\top(Ax_*-b)=0\\quad\\Longleftrightarrow\\quad A^\\top r_*=0. $ 对任意 $y$，列空间中的向量可写为 $Ay$，于是\n$ (Ay)^\\top r_* = y^\\top(A^\\top r_*) = 0, $ 即\n$ \\boxed{r_*\\perp \\operatorname{Im}(A)}. $ 又因为 $Ax_*\\in \\operatorname{Im}(A)$，我们得到分解\n$ b = Ax_* + r_*,\\qquad Ax_*\\in \\operatorname{Im}(A),\\quad r_*\\perp \\operatorname{Im}(A). $ 这恰好是“正交投影”的定义性刻画，因此\n$ \\boxed{Ax_*=\\Pi_{\\operatorname{Im}(A)}(b)}. $ 3. 最小范数 ⇒ 解与 $\\ker(A)$ 正交（并且唯一） 当 $A$ 不满列秩时，最小二乘解一般不唯一。取任意一个最小二乘解 $x_0$，可证明所有最小二乘解恰为\n$ \\mathcal{S}=x_0+\\ker(A). $ 证明要点: 若 $x$ 与 $x_0$ 都满足正规方程 $A^\\top A x=A^\\top b$，则相减得 $A^\\top A(x-x_0)=0\\Rightarrow |A(x-x_0)|^2=0\\Rightarrow x-x_0\\in\\ker(A)$；反向也成立。\n现在在 $\\mathcal{S}$ 中最小化范数：\n$ \\min_{z\\in\\ker(A)}\\|x_0+z\\|_2. $ 把 $x_0$ 按正交分解写成\n$ x_0=u+v,\\qquad u\\in\\ker(A)^\\perp,\\ v\\in\\ker(A). $ 则对任意 $z\\in\\ker(A)$，\n$ \\|x_0+z\\|^2=\\|u+(v+z)\\|^2=\\|u\\|^2+\\|v+z\\|^2, $ 最小值在 $z_*=-v$ 处取得，最小范数解为\n$ \\boxed{x_* = u \\in \\ker(A)^\\perp}. $ 并且该解唯一：因为正交分解唯一，$u$ 唯一。\n利用基本定理\n$ \\ker(A)^\\perp = \\operatorname{Im}(A^\\top), $ 得到一个常用刻画：\n$ \\boxed{x_*(b)\\in \\operatorname{Im}(A^\\top)}. $ 4. 用最小二乘 + 最小范数定义 $A^+$，并证明映射线性 对每个 $b$，令 $x_*(b)$ 为“最小二乘 + 最小范数”的唯一解。定义算子\n$ T:\\mathbb{R}^m\\to\\mathbb{R}^n,\\qquad T(b)=x_*(b). $ 4.1 一个等价的线性系统（核心） 由上面的两条结论，$x_*(b)$ 等价于解下面的系统：\n$ (\\star)\\qquad \\begin{cases} A^\\top A x = A^\\top b,\\\\ x\\in \\operatorname{Im}(A^\\top). \\end{cases} $ 第一行来自最小二乘的正规方程； 第二行来自最小范数选择（砍掉 $\\ker(A)$ 分量）。 4.2 为什么 $(\\star)$ 的解唯一？ 若 $x_1,x_2$ 都满足 $(\\star)$，令 $d=x_1-x_2$，则\n$ A^\\top A d=0 \\Rightarrow d^\\top A^\\top A d=\\|Ad\\|^2=0\\Rightarrow d\\in\\ker(A). $ 又 $d\\in\\operatorname{Im}(A^\\top)=\\ker(A)^\\perp$，所以 $d=0$。\n4.3 线性性 系统 $(\\star)$ 在固定子空间 $\\operatorname{Im}(A^\\top)$ 上解线性方程，其解对右端 $b$ 线性依赖，因此 $T$ 是线性算子。于是存在唯一矩阵（把线性算子写成矩阵）\n$ \\boxed{A^+\\in\\mathbb{R}^{n\\times m}\\ \\text{使得}\\ T(b)=A^+b}. $ 这就是摩尔–彭若斯逆的“问题驱动”构造。\n5. 两个投影：$P=AA^+$ 与 $Q=A^+A$ 5.1 $P=AA^+$ 是到 $\\operatorname{Im}(A)$ 的正交投影 给定 $b$，设 $x_*=A^+b$，则\n$ p:=Ax_*=AA^+b\\in\\operatorname{Im}(A), \\quad r:=b-p=b-AA^+b. $ 由最小二乘正交性，$r\\perp \\operatorname{Im}(A)$。因此 $p$ 是 $b$ 在 $\\operatorname{Im}(A)$ 上的正交投影：\n$ \\boxed{AA^+ = \\Pi_{\\operatorname{Im}(A)}}. $ 因此 $AA^+$ 必满足\n$ (AA^+)^2=AA^+,\\qquad (AA^+)^\\top=AA^+. $ 5.2 $Q=A^+A$ 是到 $\\operatorname{Im}(A^\\top)$ 的正交投影 对任意 $x$，令 $b=Ax$，则\n$ Qx=A^+Ax=A^+b=x_*(b)\\in\\operatorname{Im}(A^\\top), $ 所以 $Qx$ 的确落在目标子空间中。要证明正交性，只需验证对所有 $y$：\n$ \\langle x-Qx,\\ A^\\top y\\rangle=0. $ 计算：\n$ \\langle x-Qx,\\ A^\\top y\\rangle =\\langle Ax-AQx,\\ y\\rangle. $ 而接下来会由 Penrose (1)（马上推出）得到 $AQx=Ax$，于是该内积为 0。结论：\n$ \\boxed{A^+A=\\Pi_{\\operatorname{Im}(A^\\top)}}. $ 因此 $A^+A$ 也满足幂等与对称：\n$ (A^+A)^2=A^+A,\\qquad (A^+A)^\\top=A^+A. $ 6. 从投影性质推出 Penrose 四条件 下面按顺序得到四条等式。\n(1) $AA^+A=A$ 对任意 $x$，$Ax\\in \\operatorname{Im}(A)$。而 $AA^+$ 是到 $\\operatorname{Im}(A)$ 的正交投影，所以投影不改变它：\n$ AA^+(Ax)=Ax\\quad\\forall x \\ \\Rightarrow\\ AA^+A=A. $ (3) $(AA^+)^\\top=AA^+$ 正交投影算子自伴（对称），故成立。\n(2) $A^+AA^+=A^+$ 对任意 $b$，令 $x=A^+b$。由构造 $x\\in\\operatorname{Im}(A^\\top)$。而 $A^+A$ 是到 $\\operatorname{Im}(A^\\top)$ 的正交投影，所以\n$ A^+A(A^+b)=A^+b\\quad\\forall b\\ \\Rightarrow\\ A^+AA^+=A^+. $ (4) $(A^+A)^\\top=A^+A$ 同理，正交投影对称。\n至此，$A^+$ 满足 Penrose 四条件。\n7. 仅用 Penrose 四条件证明唯一性 现在抛开最小二乘构造，纯粹从四条件出发证明：若 $X,Y$ 都满足四条件，则 $X=Y$。\n7.1 先证明 $AX=AY$ 由 (1)(3)，$AX$ 与 $AY$ 都是对称幂等矩阵，即正交投影。并且由 $AXA=A$ 可知\n$ \\operatorname{Im}(AX)=\\operatorname{Im}(A), $ 所以二者都是到同一子空间 $\\operatorname{Im}(A)$ 的正交投影。正交投影唯一，故\n$ \\boxed{AX=AY}. $ 7.2 再证明 $XA=YA$ 同理由 (2)(4)，$XA$ 与 $YA$ 都是到 $\\operatorname{Im}(A^\\top)$ 的正交投影，因此\n$ \\boxed{XA=YA}. $ 7.3 “夹逼”得到 $X=Y$ 利用 (2)：\n$ X=XAX. $ 把中间的 $AX$ 换成 $AY$（因为 $AX=AY$）：\n$ X=XAY. $ 同理，对 $Y$，由 (2) 得 $Y=YAY$，把左边的 $YA$ 换成 $XA$（因为 $YA=XA$）：\n$ Y=XAY. $ 因此\n$ \\boxed{X=XAY=Y}. $ 8. 会不会无解？（存在性） 在有限维的实/复内积空间里，Penrose 四条件永远有解，并且由上一节知道解唯一。\n存在性的“构造性证明”有两条常见路线：\n最小二乘 + 最小范数路线（本文）：对每个 $b$ 存在唯一 $x_(b)$，且映射 $b\\mapsto x_(b)$ 线性，于是得到矩阵 $A^+$，并验证四条件。 SVD 显式构造：$A=U\\Sigma V^\\top$，定义 $\\Sigma^+$ 将非零奇异值取倒数、零奇异值仍为 0，令 $A^+=V\\Sigma^+U^\\top$，可直接逐条验证四条件。 备注：在无限维或缺少内积结构（如一般 Banach 空间）时，“正交投影”不一定存在/唯一，Moore–Penrose 逆可能失败；但在线性代数（有限维矩阵）场景下不会。\n9. 常用等价刻画（备忘） 正规方程：最小二乘解满足 $ A^\\top(Ax-b)=0. $ 最小范数解额外满足 $ x\\in \\operatorname{Im}(A^\\top)=(\\ker A)^\\perp. $ 投影算子： $ AA^+=\\Pi_{\\operatorname{Im}(A)},\\qquad A^+A=\\Pi_{\\operatorname{Im}(A^\\top)}. $ 对称幂等 $\\Leftrightarrow$ 正交投影： $ P^2=P,\\ P^\\top=P \\quad\\Longleftrightarrow\\quad P=\\Pi_{\\operatorname{Im}(P)}. $ 10. 小结 按“证明顺序”的一条主线是：\n最小二乘 ⇒ 残差正交 ⇒ 正交投影到 $\\operatorname{Im}(A)$ 最小范数 ⇒ 去掉 $\\ker(A)$ 分量 ⇒ 解落在 $\\operatorname{Im}(A^\\top)$ 得到线性算子 $b\\mapsto x_*(b)$，写成矩阵 $A^+$ $AA^+$ 与 $A^+A$ 识别为两个正交投影 推出 Penrose 四条件 仅由四条件可反推唯一性 这就是“摩尔逆不再旱地拔葱”的完整闭环。\n","wordCount":"538","inLanguage":"en","datePublished":"2026-01-30T00:00:00Z","dateModified":"2026-01-30T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://analyst-huang.github.io/posts/math/moore-penrose-from-ls-to-penrose/"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject","url":"https://analyst-huang.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://analyst-huang.github.io/ accesskey=h title="Blog (Alt + H)">Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://analyst-huang.github.io/posts/ title=文章><span>文章</span></a></li><li><a href=https://analyst-huang.github.io/about/ title=关于><span>关于</span></a></li><li><a href=https://analyst-huang.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://analyst-huang.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://analyst-huang.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">从最小二乘到 Penrose 四条件：摩尔–彭若斯逆的几何证明路线</h1><div class=post-meta><span title='2026-01-30 00:00:00 +0000 UTC'>January 30, 2026</span>&nbsp;·&nbsp;<span>3 min</span></div></header><div class=post-content><blockquote><p>这篇笔记按<strong>证明顺序</strong>组织：<br><strong>最小二乘 ⇒ 正交投影</strong>，<strong>最小范数 ⇒ 与 kernel 正交</strong>，<br>进而“自然构造”出 $A^+$，再推出 <strong>Penrose 四条件</strong>与<strong>唯一性</strong>，并回答“会不会无解”。</p></blockquote><hr><h2 id=1-问题动机为什么摩尔逆看上去旱地拔葱>1. 问题动机：为什么摩尔逆看上去“旱地拔葱”？<a hidden class=anchor aria-hidden=true href=#1-问题动机为什么摩尔逆看上去旱地拔葱>#</a></h2><p>如果只从“广义逆”的等式出发，Penrose 四条件</p><span class=math style=display:block;text-align:center>$
AXA=A,\quad XAX=X,\quad (AX)^\top=AX,\quad (XA)^\top=XA
$</span><p>像是凭空列出的约束。更自然的起点其实是一个极其朴素的问题：</p><blockquote><p>给定 $A\in\mathbb{R}^{m\times n}$ 与 $b\in\mathbb{R}^m$，<br>先求最小二乘 $\min_x |Ax-b|_2$；若解不唯一，再在所有最小二乘解中选范数最小的那个。</p></blockquote><p>这条路线会把“代数等式”还原成“几何投影”。</p><hr><h2 id=2-最小二乘--残差与列空间正交正交投影>2. 最小二乘 ⇒ 残差与列空间正交（正交投影）<a hidden class=anchor aria-hidden=true href=#2-最小二乘--残差与列空间正交正交投影>#</a></h2><p>考虑目标函数</p><span class=math style=display:block;text-align:center>$
f(x)=\|Ax-b\|_2^2=(Ax-b)^\top(Ax-b).
$</span><p>令残差 $r(x)=Ax-b$。对 $x$ 求梯度：</p><span class=math style=display:block;text-align:center>$
\nabla f(x)=2A^\top(Ax-b)=2A^\top r(x).
$</span><p>此处补充一个求矩阵函数梯度的小技巧：
<span class=math style=display:block;text-align:center>$$
f(x + \delta) - f(x) = \langle \nabla f(x), \delta\rangle + o(infinitesimal)
$$
</span>只要表示为这个形式，就能够知道梯度是什么。</p><p>若 $x_*$ 为极小点，则一阶必要条件</p><span class=math style=display:block;text-align:center>$
A^\top(Ax_*-b)=0\quad\Longleftrightarrow\quad A^\top r_*=0.
$</span><p>对任意 $y$，列空间中的向量可写为 $Ay$，于是</p><span class=math style=display:block;text-align:center>$
(Ay)^\top r_* = y^\top(A^\top r_*) = 0,
$</span><p>即</p><span class=math style=display:block;text-align:center>$
\boxed{r_*\perp \operatorname{Im}(A)}.
$</span><p>又因为 $Ax_*\in \operatorname{Im}(A)$，我们得到分解</p><span class=math style=display:block;text-align:center>$
b = Ax_* + r_*,\qquad Ax_*\in \operatorname{Im}(A),\quad r_*\perp \operatorname{Im}(A).
$</span><p>这恰好是“正交投影”的定义性刻画，因此</p><span class=math style=display:block;text-align:center>$
\boxed{Ax_*=\Pi_{\operatorname{Im}(A)}(b)}.
$</span><hr><h2 id=3-最小范数--解与-kera-正交并且唯一>3. 最小范数 ⇒ 解与 $\ker(A)$ 正交（并且唯一）<a hidden class=anchor aria-hidden=true href=#3-最小范数--解与-kera-正交并且唯一>#</a></h2><p>当 $A$ 不满列秩时，最小二乘解一般不唯一。取任意一个最小二乘解 $x_0$，可证明所有最小二乘解恰为</p><span class=math style=display:block;text-align:center>$
\mathcal{S}=x_0+\ker(A).
$</span><p><strong>证明要点:</strong> 若 $x$ 与 $x_0$ 都满足正规方程 $A^\top A x=A^\top b$，则相减得
$A^\top A(x-x_0)=0\Rightarrow |A(x-x_0)|^2=0\Rightarrow x-x_0\in\ker(A)$；反向也成立。</p><p>现在在 $\mathcal{S}$ 中最小化范数：</p><span class=math style=display:block;text-align:center>$
\min_{z\in\ker(A)}\|x_0+z\|_2.
$</span><p>把 $x_0$ 按正交分解写成</p><span class=math style=display:block;text-align:center>$
x_0=u+v,\qquad u\in\ker(A)^\perp,\ v\in\ker(A).
$</span><p>则对任意 $z\in\ker(A)$，</p><span class=math style=display:block;text-align:center>$
\|x_0+z\|^2=\|u+(v+z)\|^2=\|u\|^2+\|v+z\|^2,
$</span><p>最小值在 $z_*=-v$ 处取得，最小范数解为</p><span class=math style=display:block;text-align:center>$
\boxed{x_* = u \in \ker(A)^\perp}.
$</span><p>并且该解唯一：因为正交分解唯一，$u$ 唯一。</p><p>利用基本定理</p><span class=math style=display:block;text-align:center>$
\ker(A)^\perp = \operatorname{Im}(A^\top),
$</span><p>得到一个常用刻画：</p><span class=math style=display:block;text-align:center>$
\boxed{x_*(b)\in \operatorname{Im}(A^\top)}.
$</span><hr><h2 id=4-用最小二乘--最小范数定义-a并证明映射线性>4. 用最小二乘 + 最小范数定义 $A^+$，并证明映射线性<a hidden class=anchor aria-hidden=true href=#4-用最小二乘--最小范数定义-a并证明映射线性>#</a></h2><p>对每个 $b$，令 $x_*(b)$ 为“最小二乘 + 最小范数”的唯一解。定义算子</p><span class=math style=display:block;text-align:center>$
T:\mathbb{R}^m\to\mathbb{R}^n,\qquad T(b)=x_*(b).
$</span><h3 id=41-一个等价的线性系统核心>4.1 一个等价的线性系统（核心）<a hidden class=anchor aria-hidden=true href=#41-一个等价的线性系统核心>#</a></h3><p>由上面的两条结论，$x_*(b)$ 等价于解下面的系统：</p><span class=math style=display:block;text-align:center>$
(\star)\qquad
\begin{cases}
A^\top A x = A^\top b,\\
x\in \operatorname{Im}(A^\top).
\end{cases}
$</span><ul><li>第一行来自最小二乘的正规方程；</li><li>第二行来自最小范数选择（砍掉 $\ker(A)$ 分量）。</li></ul><h3 id=42-为什么-star-的解唯一>4.2 为什么 $(\star)$ 的解唯一？<a hidden class=anchor aria-hidden=true href=#42-为什么-star-的解唯一>#</a></h3><p>若 $x_1,x_2$ 都满足 $(\star)$，令 $d=x_1-x_2$，则</p><span class=math style=display:block;text-align:center>$
A^\top A d=0 \Rightarrow d^\top A^\top A d=\|Ad\|^2=0\Rightarrow d\in\ker(A).
$</span><p>又 $d\in\operatorname{Im}(A^\top)=\ker(A)^\perp$，所以 $d=0$。</p><h3 id=43-线性性>4.3 线性性<a hidden class=anchor aria-hidden=true href=#43-线性性>#</a></h3><p>系统 $(\star)$ 在固定子空间 $\operatorname{Im}(A^\top)$ 上解线性方程，其解对右端 $b$ 线性依赖，因此 $T$ 是线性算子。于是存在唯一矩阵（把线性算子写成矩阵）</p><span class=math style=display:block;text-align:center>$
\boxed{A^+\in\mathbb{R}^{n\times m}\ \text{使得}\ T(b)=A^+b}.
$</span><p>这就是摩尔–彭若斯逆的“问题驱动”构造。</p><hr><h2 id=5-两个投影paa-与-qaa>5. 两个投影：$P=AA^+$ 与 $Q=A^+A$<a hidden class=anchor aria-hidden=true href=#5-两个投影paa-与-qaa>#</a></h2><h3 id=51-paa-是到-operatornameima-的正交投影>5.1 $P=AA^+$ 是到 $\operatorname{Im}(A)$ 的正交投影<a hidden class=anchor aria-hidden=true href=#51-paa-是到-operatornameima-的正交投影>#</a></h3><p>给定 $b$，设 $x_*=A^+b$，则</p><span class=math style=display:block;text-align:center>$
p:=Ax_*=AA^+b\in\operatorname{Im}(A),
\quad r:=b-p=b-AA^+b.
$</span><p>由最小二乘正交性，$r\perp \operatorname{Im}(A)$。因此 $p$ 是 $b$ 在 $\operatorname{Im}(A)$ 上的正交投影：</p><span class=math style=display:block;text-align:center>$
\boxed{AA^+ = \Pi_{\operatorname{Im}(A)}}.
$</span><p>因此 $AA^+$ 必满足</p><span class=math style=display:block;text-align:center>$
(AA^+)^2=AA^+,\qquad (AA^+)^\top=AA^+.
$</span><h3 id=52-qaa-是到-operatornameimatop-的正交投影>5.2 $Q=A^+A$ 是到 $\operatorname{Im}(A^\top)$ 的正交投影<a hidden class=anchor aria-hidden=true href=#52-qaa-是到-operatornameimatop-的正交投影>#</a></h3><p>对任意 $x$，令 $b=Ax$，则</p><span class=math style=display:block;text-align:center>$
Qx=A^+Ax=A^+b=x_*(b)\in\operatorname{Im}(A^\top),
$</span><p>所以 $Qx$ 的确落在目标子空间中。要证明正交性，只需验证对所有 $y$：</p><span class=math style=display:block;text-align:center>$
\langle x-Qx,\ A^\top y\rangle=0.
$</span><p>计算：</p><span class=math style=display:block;text-align:center>$
\langle x-Qx,\ A^\top y\rangle
=\langle Ax-AQx,\ y\rangle.
$</span><p>而接下来会由 Penrose (1)（马上推出）得到 $AQx=Ax$，于是该内积为 0。结论：</p><span class=math style=display:block;text-align:center>$
\boxed{A^+A=\Pi_{\operatorname{Im}(A^\top)}}.
$</span><p>因此 $A^+A$ 也满足幂等与对称：</p><span class=math style=display:block;text-align:center>$
(A^+A)^2=A^+A,\qquad (A^+A)^\top=A^+A.
$</span><hr><h2 id=6-从投影性质推出-penrose-四条件>6. 从投影性质推出 Penrose 四条件<a hidden class=anchor aria-hidden=true href=#6-从投影性质推出-penrose-四条件>#</a></h2><p>下面按顺序得到四条等式。</p><h3 id=1-aaaa>(1) $AA^+A=A$<a hidden class=anchor aria-hidden=true href=#1-aaaa>#</a></h3><p>对任意 $x$，$Ax\in \operatorname{Im}(A)$。而 $AA^+$ 是到 $\operatorname{Im}(A)$ 的正交投影，所以投影不改变它：</p><span class=math style=display:block;text-align:center>$
AA^+(Ax)=Ax\quad\forall x \ \Rightarrow\ AA^+A=A.
$</span><h3 id=3-aatopaa>(3) $(AA^+)^\top=AA^+$<a hidden class=anchor aria-hidden=true href=#3-aatopaa>#</a></h3><p>正交投影算子自伴（对称），故成立。</p><h3 id=2-aaaa>(2) $A^+AA^+=A^+$<a hidden class=anchor aria-hidden=true href=#2-aaaa>#</a></h3><p>对任意 $b$，令 $x=A^+b$。由构造 $x\in\operatorname{Im}(A^\top)$。而 $A^+A$ 是到 $\operatorname{Im}(A^\top)$ 的正交投影，所以</p><span class=math style=display:block;text-align:center>$
A^+A(A^+b)=A^+b\quad\forall b\ \Rightarrow\ A^+AA^+=A^+.
$</span><h3 id=4-aatopaa>(4) $(A^+A)^\top=A^+A$<a hidden class=anchor aria-hidden=true href=#4-aatopaa>#</a></h3><p>同理，正交投影对称。</p><p>至此，$A^+$ 满足 Penrose 四条件。</p><hr><h2 id=7-仅用-penrose-四条件证明唯一性>7. 仅用 Penrose 四条件证明唯一性<a hidden class=anchor aria-hidden=true href=#7-仅用-penrose-四条件证明唯一性>#</a></h2><p>现在抛开最小二乘构造，纯粹从四条件出发证明：若 $X,Y$ 都满足四条件，则 $X=Y$。</p><h3 id=71-先证明-axay>7.1 先证明 $AX=AY$<a hidden class=anchor aria-hidden=true href=#71-先证明-axay>#</a></h3><p>由 (1)(3)，$AX$ 与 $AY$ 都是对称幂等矩阵，即正交投影。并且由 $AXA=A$ 可知</p><span class=math style=display:block;text-align:center>$
\operatorname{Im}(AX)=\operatorname{Im}(A),
$</span><p>所以二者都是到同一子空间 $\operatorname{Im}(A)$ 的正交投影。正交投影唯一，故</p><span class=math style=display:block;text-align:center>$
\boxed{AX=AY}.
$</span><h3 id=72-再证明-xaya>7.2 再证明 $XA=YA$<a hidden class=anchor aria-hidden=true href=#72-再证明-xaya>#</a></h3><p>同理由 (2)(4)，$XA$ 与 $YA$ 都是到 $\operatorname{Im}(A^\top)$ 的正交投影，因此</p><span class=math style=display:block;text-align:center>$
\boxed{XA=YA}.
$</span><h3 id=73-夹逼得到-xy>7.3 “夹逼”得到 $X=Y$<a hidden class=anchor aria-hidden=true href=#73-夹逼得到-xy>#</a></h3><p>利用 (2)：</p><span class=math style=display:block;text-align:center>$
X=XAX.
$</span><p>把中间的 $AX$ 换成 $AY$（因为 $AX=AY$）：</p><span class=math style=display:block;text-align:center>$
X=XAY.
$</span><p>同理，对 $Y$，由 (2) 得 $Y=YAY$，把左边的 $YA$ 换成 $XA$（因为 $YA=XA$）：</p><span class=math style=display:block;text-align:center>$
Y=XAY.
$</span><p>因此</p><span class=math style=display:block;text-align:center>$
\boxed{X=XAY=Y}.
$</span><hr><h2 id=8-会不会无解存在性>8. 会不会无解？（存在性）<a hidden class=anchor aria-hidden=true href=#8-会不会无解存在性>#</a></h2><p>在<strong>有限维</strong>的实/复内积空间里，Penrose 四条件<strong>永远有解</strong>，并且由上一节知道<strong>解唯一</strong>。</p><p>存在性的“构造性证明”有两条常见路线：</p><ol><li><strong>最小二乘 + 最小范数路线（本文）</strong>：对每个 $b$ 存在唯一 $x_<em>(b)$，且映射 $b\mapsto x_</em>(b)$ 线性，于是得到矩阵 $A^+$，并验证四条件。</li><li><strong>SVD 显式构造</strong>：$A=U\Sigma V^\top$，定义 $\Sigma^+$ 将非零奇异值取倒数、零奇异值仍为 0，令 $A^+=V\Sigma^+U^\top$，可直接逐条验证四条件。</li></ol><blockquote><p>备注：在无限维或缺少内积结构（如一般 Banach 空间）时，“正交投影”不一定存在/唯一，Moore–Penrose 逆可能失败；但在线性代数（有限维矩阵）场景下不会。</p></blockquote><hr><h2 id=9-常用等价刻画备忘>9. 常用等价刻画（备忘）<a hidden class=anchor aria-hidden=true href=#9-常用等价刻画备忘>#</a></h2><ul><li>正规方程：最小二乘解满足
<span class=math style=display:block;text-align:center>$
A^\top(Ax-b)=0.
$</span></li><li>最小范数解额外满足
<span class=math style=display:block;text-align:center>$
x\in \operatorname{Im}(A^\top)=(\ker A)^\perp.
$</span></li><li>投影算子：
<span class=math style=display:block;text-align:center>$
AA^+=\Pi_{\operatorname{Im}(A)},\qquad A^+A=\Pi_{\operatorname{Im}(A^\top)}.
$</span></li><li>对称幂等 $\Leftrightarrow$ 正交投影：
<span class=math style=display:block;text-align:center>$
P^2=P,\ P^\top=P \quad\Longleftrightarrow\quad P=\Pi_{\operatorname{Im}(P)}.
$</span></li></ul><hr><h2 id=10-小结>10. 小结<a hidden class=anchor aria-hidden=true href=#10-小结>#</a></h2><p>按“证明顺序”的一条主线是：</p><ol><li>最小二乘 ⇒ 残差正交 ⇒ 正交投影到 $\operatorname{Im}(A)$</li><li>最小范数 ⇒ 去掉 $\ker(A)$ 分量 ⇒ 解落在 $\operatorname{Im}(A^\top)$</li><li>得到线性算子 $b\mapsto x_*(b)$，写成矩阵 $A^+$</li><li>$AA^+$ 与 $A^+A$ 识别为两个正交投影</li><li>推出 Penrose 四条件</li><li>仅由四条件可反推唯一性</li></ol><p>这就是“摩尔逆不再旱地拔葱”的完整闭环。</p><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://analyst-huang.github.io/tags/linear-algebra/>Linear Algebra</a></li><li><a href=https://analyst-huang.github.io/tags/least-squares/>Least Squares</a></li><li><a href=https://analyst-huang.github.io/tags/pseudoinverse/>Pseudoinverse</a></li><li><a href=https://analyst-huang.github.io/tags/moore-penrose/>Moore-Penrose</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://analyst-huang.github.io/>Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>